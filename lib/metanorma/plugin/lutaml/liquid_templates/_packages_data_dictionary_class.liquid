{% capture equalsigns %}{% for count in (1..depth) %}={% endfor %}{% endcapture %}
{% capture generalizations %}{% assign inheritance = klass.associations | where: "member_end_type", "inheritance" %}{% for assoc in inheritance %}{{ assoc.member_end }}{% endfor %}{% endcapture %}
[[{{ klass.name }}-section]]
{{equalsigns}} {{ klass.name }}
{%comment%}(inside class: depth is {{ depth }}, equalsigns {{equalsigns}}){%endcomment%}

.Metadata of {{ klass.name }} ({{klass.stereotype}})
[cols="1a,4a"]
|===
h| Definition:  | {{ klass.definition | replace: '|', '\|' }}
h| Subclass of: | {% if generalizations.size > 0 %}{{ generalizations }}{% else %}None{% endif %}
h| Stereotype:  | «{{ klass.stereotype }}»

{% if klass.constraints.size > 0 %}
{% for constraint in klass.constraints %}
h| Constraint:
| `{{ constraint.body }}`: `{{ constraint.definition | replace: '|', '\|' }}`

{% endfor %}
{% endif %}
|===

{% if klass.associations.size > 0 %}
{% capture rendered_associations %}
{% for assoc in klass.associations %}
{% if assoc.member_end_attribute_name.size > 0 %}
{% capture cardinality %}{% if assoc.member_end_cardinality.min == 'C' %}[0..{{ assoc.member_end_cardinality.max }}]{% elsif assoc.member_end_cardinality.min == 'M' and assoc.member_end_cardinality.max == '1' %}[1..1]{% else %}[{{ assoc.member_end_cardinality.max }}]{% endif %}{% endcapture %}
| {{ assoc.member_end_attribute_name }}
| <<{{assoc.member_end}}-section,{{assoc.member_end}}>> {{ cardinality }}
| {{ assoc.definition | replace: '|', '\|' }}
{% endif %}
{% endfor %}
{% endcapture %}
{% assign associations_stripped = rendered_associations | strip_newlines | strip %}

{% if associations_stripped.size > 0 %}
.Associations of {{ klass.name }} ({{ klass.stereotype }})
[cols="15a,20a,60a",options="header"]
|===
| Role name | Target class and multiplicity | Definition

{{ rendered_associations }}

|===
{% endif %}
{% endif %}

{% if klass.attributes.size > 0 %}
.Attributes of {{ klass.name }} ({{klass.stereotype}})
[cols="15a,20a,60a",options="header"]
|===
| Attribute | Value type and multiplicity | Definition

{% for attr in klass.attributes %}
{% capture cardinality %}{% if attr.cardinality.min == 'C' %}[0..{{ attr.cardinality.max }}]{% elsif assoc.member_end_cardinality.min == 'M' and assoc.member_end_cardinality.max == '1' %}[1..1]{% else %}[{{ attr.cardinality.max }}]{% endif %}{% endcapture %}
| {{ attr.name }}
| <<{{ attr.type }}-section,{{ attr.type }}>> {{ cardinality }}
| {{ attr.definition | replace: '|', '\|' }}

{% endfor %}
|===

[NOTE,keep-separate=true]
====
Unless otherwise specified, all attributes and role names have the stereotype
«Property».
====
{% endif %}
